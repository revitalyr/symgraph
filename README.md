
# symgraph (CLI + SQLite)

Semantic symbol graph builder for C++ (CMake + C++20 modules) and Rust.
- Extracts **definitions/uses** with libclang (USR-based), builds **call/inheritance/member** hierarchies.
- Imports simple C++20 module graph (based on `export module`/`import`).
- Stores results in **SQLite**.

## Quick start (Windows, MSVC/VS2022)

1. Open **Developer PowerShell for VS 2022**.
2. Install Ninja & LLVM:
   ```powershell
   winget install Ninja-build.Ninja
   winget install LLVM.LLVM
   ```
3. Install Rust:
   ```powershell
   winget install Rustlang.Rustup
   rustup default stable
   ```
4. Configure your CMake project with Ninja:
   ```powershell
   cmake -S examples/cpp20_modules -B build -G "Ninja"      -DCMAKE_CXX_STANDARD=20 -DCMAKE_CXX_STANDARD_REQUIRED=ON      -DCMAKE_CXX_SCAN_FOR_MODULES=ON -DCMAKE_EXPORT_COMPILE_COMMANDS=ON
   cmake --build build
   ```
5. Run analysis:
   ```powershell
   cargo run -p symgraph-cli -- scan-cxx --compdb build/compile_commands.json --db symgraph.db
   cargo run -p symgraph-cli -- import-modules --root examples/cpp20_modules --db symgraph.db
   ```
6. Query (example: list callees from a given USR):
   ```powershell
   cargo run -p symgraph-cli -- query-calls --db symgraph.db --usr "c:@F@foo#"
   ```

> Notes:
> - `compile_commands.json` is generated by **Ninja/Makefiles** (not by VS generators). Use Ninja for analysis.
> - If your libclang version differs (e.g. 17), edit `crates/symgraph-cli/Cargo.toml` to set `clang` feature (e.g. `clang_17_0`).

## Layout
```
symgraph/
  Cargo.toml (workspace)
  crates/
    symgraph-cli/
    symgraph-core/
    symgraph-discovery/
    symgraph-cxx/
    symgraph-rust/
  examples/
    cpp20_modules/
      CMakeLists.txt
      foo.cppm
      main.cpp
```

